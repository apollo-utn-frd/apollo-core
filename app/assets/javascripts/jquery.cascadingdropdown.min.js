/*! jquery-cascading-dropdown 1.2.7 | (c) 2017 Dzulqarnain Nasir <dzul1983@gmail.com> | MIT */
!function(e,n){"use strict";function t(n,t){this.el=e(n.selector,t.el),this.parent=t,this.options=e.extend({},o,n),this.name=this.options.paramName||this.el.attr("name"),this.requiredDropdowns=n.requires&&n.requires.length?e(n.requires.join(","),t.el):null,this.isLoadingClassName=this.options.isLoadingClassName||t.options.isLoadingClassName||"cascading-dropdown-loading"}function i(n,t){this.el=e(n),this.options=e.extend({selectBoxes:[]},t),this._init()}var o={usePost:!1,useJson:!1};t.prototype={_create:function(){var e=this;e.pending=0,e.initialised=!1,e.initialState=e.el.clone(!0),e.el.data("plugin_cascadingDropdown",this),e.originalDropdownItems=e.el.children("option"),"function"==typeof e.options.onChange&&e.el.change(function(n){var t=e._requirementsMet()&&e.el[0].value;e.options.onChange.call(e,n,e.el.val(),e.getRequiredValues(),t)}),"function"==typeof e.options.onEnable&&e.el.on("enabled",function(n){e.options.onEnable.call(e,n,e.el.val())}),"function"==typeof e.options.onDisable&&e.el.on("disabled",function(n){e.options.onDisable.call(e,n,e.el.val())}),e.requiredDropdowns&&e.requiredDropdowns.change(function(n){e.update()}),e._initSource(),e.update()},_destroy:function(){this.el.replaceWith(this.initialState).removeData("plugin_cascadingDropdown")},enable:function(){this.el.attr("disabled")!==n&&this.el.removeAttr("disabled").triggerHandler("enabled")},disable:function(){this.el.attr("disabled")===n&&this.el.attr("disabled","disabled").triggerHandler("disabled")},_requirementsMet:function(){var n=this;return!n.requiredDropdowns||(n.options.requireAll?n.requiredDropdowns.filter(function(){return!!e(this).val()}).length==n.options.requires.length:n.requiredDropdowns.filter(function(){return!!e(this).val()}).length>0)},_initSource:function(){var t=this;if(e.isArray(t.options.source))this.source=function(n,i){i(e.map(t.options.source,function(e){return{label:e.label||e.value||e,value:e.value||e.label||e,selected:e.selected}}))};else if("string"==typeof t.options.source){var i=t.options.source;this.source=function(o,r){t.xhr&&t.xhr.abort(),t.xhr=e.ajax({url:i,data:t.options.useJson?JSON.stringify(o):o,dataType:t.options.useJson?"json":n,type:t.options.usePost?"post":"get",contentType:"application/json; charset=utf-8",success:function(e){r(e)},error:function(){r([])}})}}else this.source=t.options.source},getRequiredValues:function(){var n={};return this.requiredDropdowns&&e.each(this.requiredDropdowns,function(){var t=e(this).data("plugin_cascadingDropdown");t.name&&(n[t.name]=t.el.val())}),n},update:function(){var e=this;if(e.disable(),!e._requirementsMet())return e.setSelected(0),e._triggerReady(),e.el;if(!e.source)return e.enable(),e._triggerReady(),e.el;e.el.val("").change();var n=e.getRequiredValues();return e.pending++,e.el.addClass(e.isLoadingClassName),e.source(n,e._response()),e.el},_response:function(e){var n=this;return function(e){n._renderItems(e),n.pending--,n.pending||n.el.removeClass(n.isLoadingClassName)}},_renderItems:function(n){var t=this;if(t.el.find("option, optgroup").remove(),t.el.append(t.originalDropdownItems),!n)return void t._triggerReady();var i=[],o=function(e){var n="";return e.selected&&i.push(e.value.toString()),'<option value="'+e.value+'"'+n+">"+e.label+"</option>"};e.isArray(n)?e.each(n,function(e,n){t.el.append(o(n))}):e.each(n,function(e,n){var i=[];i.push('<optgroup label="'+e+'">');for(var r=0;r<n.length;r++){var s=n[r];i.push(o(s))}i.push("</optgroup>"),t.el.append(i.join(""))}),t.enable(),i.length&&t.setSelected(i),t._triggerReady()},_triggerReady:function(){this.initialised||(this.options.selected&&this.setSelected(this.options.selected),this.initialised=!0,this.el.triggerHandler("ready"))},setSelected:function(t,i){var o=this,r=o.el.find("option");"undefined"==typeof i&&(i=!0);var s=[];s=e.isArray(t)?t:s.concat(t);var a;return o.el.is("[multiple]")?a=s.map(function(e){return"number"==typeof e&&e!==n&&e>-1&&e<r.length?r[e].value:e}):(a=s[0],"number"==typeof s[0]&&s[0]!==n&&s[0]>-1&&s[0]<r.length&&(a=r[s[0]].value)),o.el.val(a),i&&o.el.change(),o.el}},i.prototype={_init:function(){function n(e){++s==r.length&&(r.unbind("ready",n),o.options.onReady.call(o,e,o.getValues()))}function i(e){o.options.onChange.call(o,e,o.getValues())}var o=this;o.pending=0,o.dropdowns=[];var r=e(e.map(o.options.selectBoxes,function(e){return e.selector}).join(","),o.el),s=0;"function"==typeof o.options.onReady&&r.bind("ready",n),"function"==typeof o.options.onChange&&r.bind("change",i),e.each(o.options.selectBoxes,function(e,n){var i=new t(this,o);o.dropdowns.push(i),i._create()})},destroy:function(){return e.each(this.dropdowns,function(e,n){n._destroy()}),this.el.removeData("plugin_cascadingDropdown"),this.el},getValues:function(){var n={};return e.each(this.dropdowns,function(e,t){t.name&&(n[t.name]=t.el.val())}),n}},e.fn.cascadingDropdown=function(n){var t=e(this),o=arguments,r=t.data("plugin_cascadingDropdown");if("object"==typeof n||!n)return!r&&t.data("plugin_cascadingDropdown",new i(this,n));if("string"==typeof n)if(r){if(r[n])return r[n].apply(r,Array.prototype.slice.call(o,1))}else e.error("Cannot call method "+n+" before init.");else e.error("Method "+n+" does not exist in jQuery.cascadingDropdown")}}(jQuery);
//# sourceMappingURL=jquery.cascadingdropdown.min.js.map
